{"version":3,"mappings":"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","names":["y","constructor","ngOnInit","r","selectors","e","I","t","n","this","a","H","b","sus","store","subscribe","i","user","data","form","value","name","setTimeout","nativeElement","focus","ngOnDestroy","unsubscribe","createHeritage","valid","controls","c","u","m","person","id","h","HeritageService","heritage","reset","l","heritages","dispatch","d","console","log","M","path","component","canActivate","S","children","Z","yearValue","Date","getFullYear","susA","actions","type","buildForm","sub","select","heritagesFilter","search","active","localStorage","itemsStatesHeritage","JSON","stringify","updateState","g","searchHeritages","length","statesItems","parse","updateStates","O","f","G","p","D","j","L"],"sources":["./src/app/pages/dashboard/heritage/start-heritage/start-heritage.component.ts","./src/app/pages/dashboard/heritage/create/create-heritage.component.html","./src/app/pages/dashboard/heritage/create/create-heritage.component.ts","./src/app/pages/dashboard/heritage/heritage.component.html","./src/app/pages/dashboard/heritage/heritage-routing.module.ts","./src/app/pages/dashboard/heritage/heritage.component.ts","./src/app/pages/dashboard/heritage/heritage.module.ts"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-start-heritage',\r\n  template: `<router-outlet></router-outlet>`\r\n})\r\nexport class StartHeritageComponent implements OnInit {\r\n\r\n  constructor() { }\r\n\r\n  ngOnInit() {\r\n  }\r\n\r\n}\r\n","<div class=\"container pt-5 mx-auto\">\r\n  <div class=\"grid gap-4\">\r\n    <div>\r\n      <div class=\"pt-5 mx-auto\">\r\n        <h1 class=\"text-center font-bold text-2xl mt-7 mb-5\"><span class=\"icon-note mr-2\"></span> Create Heritage</h1>\r\n\r\n        <form class=\"grid sm:col-span-2 md:grid-cols-3 gap-4\" [formGroup]=\"form\" (ngSubmit)=\"createHeritage()\">\r\n          <div class=\"w-full sm:col-span-2\">\r\n            <input type=\"text\" placeholder=\"name\" formControlName=\"name\" class=\"w-full p-2 mb-2\" #value>\r\n          </div>\r\n          <div class=\"w-full sm:col-span-2 md:col-span-1\">\r\n            <input type=\"number\" placeholder=\"Value\" formControlName=\"value\" class=\"w-full p-2 mb-2\" >\r\n          </div>\r\n          <div class=\"w-full sm:col-span-2 md:col-span-3\">\r\n            <button type=\"submit\" class=\"btn-form\">Create</button>\r\n          </div>\r\n        </form>\r\n      </div>\r\n      <div *ngIf=\"user?.heritages?.data?.length && details\">\r\n        <h1 class=\"text-center text-2xl mt-7 mb-5\"><b *ngIf=\"user?.heritages?.data?.length\">({{user?.heritages?.data?.length}})</b> All Your Heritage <b>{{user?.heritages?.total | currency:'$':'symbol':'4.0'}}</b></h1>\r\n\r\n        <app-heritage-person \r\n          [showHeader]=\"false\" \r\n          [showLink]=\"false\" \r\n          [showDelete]=\"true\" \r\n          [padding]=\"false\" \r\n          [limit]=\"20\"></app-heritage-person>\r\n      </div>\r\n\r\n      <div class=\"text-center text-xl py-2 mt-6 font-semibold\" *ngIf=\"!user?.heritages?.data?.length\">\r\n        There're nothing to see in your <b>Heritage</b>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n","import { Component, ElementRef, Input, OnInit, ViewChild } from '@angular/core';\r\nimport { FormControl, FormGroup, Validators } from '@angular/forms';\r\nimport { Store } from '@ngrx/store';\r\nimport { Subscription } from 'rxjs';\r\nimport { IUserData } from 'src/app/interfaces/user';\r\nimport { HeritageService } from 'src/app/services/heritage.service';\r\nimport { IState } from 'src/app/store';\r\nimport { HeritagePerson } from 'src/app/store/actions/user';\r\nimport { currentDateInput } from 'src/environments/global';\r\n\r\n@Component({\r\n  selector: 'app-create-heritage',\r\n  templateUrl: './create-heritage.component.html',\r\n  styles: [],\r\n})\r\nexport class CreateHeritageComponent implements OnInit {\r\n  @Input() details: boolean = true;\r\n  form: FormGroup = new FormGroup({});\r\n  @ViewChild('value', { static : true }) value: ElementRef | undefined;\r\n\r\n  sus: Subscription = new Subscription();\r\n  user: IUserData = {};\r\n\r\n  date: string = currentDateInput();\r\n\r\n  constructor(private HeritageService: HeritageService, private store: Store<IState>) {\r\n    this.sus = this.store.subscribe((state) => {\r\n      this.user = state.user.data;\r\n    });\r\n  }\r\n\r\n  async ngOnInit() {\r\n    this.form = new FormGroup({\r\n      value: new FormControl('', Validators.required),\r\n      name: new FormControl(''),\r\n    });\r\n\r\n    setTimeout(() => this.value?.nativeElement.focus(), 300);\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    this.sus.unsubscribe();\r\n  }\r\n\r\n  async createHeritage() {\r\n    if (this.form.valid) {\r\n      let { value, name } = this.form.controls;\r\n\r\n      try {\r\n        let data = {\r\n          value: value.value,\r\n          name: name.value,\r\n          person: this.user?.person?.id,\r\n        };\r\n        let response: any = await this.HeritageService.createHeritage(data);\r\n\r\n        if (response.heritage) {\r\n          // console.log('registro exitoso');\r\n          this.form.reset();\r\n\r\n          this.value?.nativeElement.focus();\r\n\r\n          if(response.heritages){\r\n            this.store.dispatch(HeritagePerson({ heritages: response.heritages }));\r\n          }\r\n        } else {\r\n          console.log('registro fallido');\r\n        }\r\n      } catch (error) {\r\n        console.log('error => ', error);\r\n      }\r\n    }\r\n  }\r\n}\r\n","<app-create-heritage [details]=\"false\"></app-create-heritage>\r\n\r\n<div class=\"container pt-5 mx-auto\" *ngIf=\"user?.heritages?.data?.length\">\r\n  <div class=\"grid gap-4\">\r\n    <form [formGroup]=\"form\">\r\n      <div class=\"grid grid-cols-3 gap-x-8\">\r\n        <h1 class=\"text-center text-2xl mt-7 mb-5 col-span-3\"><b>({{user?.heritages?.data?.length}})</b> total items in your Heritage = <b>{{user?.heritages?.total | currency:'$':'symbol':'4.0'}}</b></h1>\r\n  \r\n        <div class=\"text-right my-2\">\r\n          <input type=\"search\" placeholder=\"Search Heritage for Name\" class=\"w-full py-1 px-3\" formControlName=\"search\" (keyup.enter)=\"heritagesFilter()\">\r\n        </div>\r\n\r\n        <div class=\"flex items-center\">\r\n          <label>\r\n            <input type=\"checkbox\" name=\"active\" formControlName=\"active\" checked=\"true\" (change)=\"heritagesFilter()\"> Active\r\n          </label>\r\n        </div>\r\n\r\n        <div class=\"flex items-end justify-end\">\r\n          <button class=\"p-1 px-3 text-white transition-all rounded-md mb-2 text-sm\" [ngClass]=\"{'bg-noti hover:bg-purple-900': !updateState, 'bg-green hover:bg-green-900': updateState}\" (click)=\"statesItems(user)\">\r\n            <span *ngIf=\"!updateState\"><span class=\"icon-bell\"></span> Change State</span>\r\n            <span *ngIf=\"updateState\"><span class=\"icon-bell-o\"></span> Save Data</span>\r\n          </button>\r\n        </div>\r\n\r\n        <div class=\" col-span-3\">\r\n          <app-heritage-person \r\n            [showHeader]=\"false\" \r\n            [showLink]=\"false\" \r\n            [showDelete]=\"true\" \r\n            [padding]=\"false\" \r\n            [updateState]=\"updateState\"\r\n            [limit]=\"500\"></app-heritage-person>\r\n        </div>\r\n      </div>\r\n    </form>\r\n  </div>\r\n</div>\r\n","import { RouterModule, Routes } from \"@angular/router\";\r\nimport { DashboardService } from \"src/app/guards/dashboard.service\";\r\nimport { NgModule } from \"@angular/core\";\r\nimport { StartHeritageComponent } from \"./start-heritage/start-heritage.component\";\r\nimport { HeritagePersonComponent } from \"src/app/components/heritage-person/heritage-person.component\";\r\nimport { HeritageComponent } from \"./heritage.component\";\r\n\r\nconst routes: Routes = [\r\n    { \r\n        path: '', component: StartHeritageComponent, canActivate: [DashboardService],\r\n        children: [\r\n            { path: '', component: HeritagePersonComponent },\r\n            { path: 'create', component: HeritageComponent },\r\n        ]\r\n    },\r\n];\r\n\r\n@NgModule({\r\n    imports: [RouterModule.forChild(routes)],\r\n    exports: [RouterModule]\r\n  })\r\nexport class HeritageRoutingModule {}\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { FormControl, FormGroup, Validators } from '@angular/forms';\r\nimport { Actions } from '@ngrx/effects';\r\nimport { Store } from '@ngrx/store';\r\nimport { Subscription } from 'rxjs';\r\nimport { IUserData } from 'src/app/interfaces/user';\r\nimport { HeritageService } from 'src/app/services/heritage.service';\r\nimport { IState } from 'src/app/store';\r\nimport { HeritagePerson, HeritageUpdateStates } from 'src/app/store/actions/user';\r\n\r\n@Component({\r\n  selector: 'app-heritage',\r\n  templateUrl: './heritage.component.html'\r\n})\r\nexport class HeritageComponent implements OnInit {\r\n  user:IUserData = {};\r\n  form: FormGroup = new FormGroup({});\r\n\r\n  yearValue: any;\r\n\r\n  updateState: boolean = false;\r\n\r\n  susA: Subscription = new Subscription();\r\n  sub: Subscription = new Subscription();\r\n\r\n  constructor(\r\n    private store: Store<IState>, \r\n    private HeritageService: HeritageService,\r\n    private actions: Actions<IState>\r\n  ) {\r\n    this.yearValue = new Date().getFullYear();\r\n\r\n    this.susA = this.actions.subscribe((action: any) => {\r\n      if(action.type === '[User] UpdateStatesHeritage'){\r\n        this.buildForm();\r\n      }\r\n    });\r\n\r\n    this.sub = this.store.select(state => state?.user?.data).subscribe(data => {\r\n      try {\r\n        this.user = data;\r\n      } catch (error) { console.log(error); }\r\n    })\r\n\r\n    this.buildForm();\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    this.susA.unsubscribe();\r\n  }\r\n  \r\n  ngOnInit(): void {\r\n    this.heritagesFilter();\r\n  }\r\n\r\n  buildForm(): void {\r\n    this.form = new FormGroup({\r\n      search: new FormControl('', Validators.required),\r\n      active: new FormControl(true, Validators.required),\r\n    });\r\n  }\r\n\r\n  async heritagesFilter() {\r\n    // console.clear();\r\n    // console.log(this.form.controls.search.value);\r\n\r\n    localStorage.itemsStatesHeritage = JSON.stringify([]);\r\n    this.updateState = false;\r\n\r\n    let params: any = {};\r\n\r\n    if(this.form.controls.search.value || this.form.controls.active.value !== null){\r\n      params = {\r\n        search: this.form.controls.search.value,\r\n        active: this.form.controls.active.value,\r\n        person: this.user?.person?.id,\r\n      };\r\n      let response: any = await this.HeritageService.searchHeritages(params);\r\n\r\n      console.log(response);\r\n\r\n      if (response?.heritages.length) {\r\n        this.store.dispatch(HeritagePerson({ heritages: response }));\r\n      }else{\r\n        this.store.dispatch(HeritagePerson({ heritages: response }));\r\n      }\r\n\r\n      return;\r\n    }\r\n\r\n    if(!this.form.controls.search.value){\r\n      try {\r\n        let response: any = await this.HeritageService.heritages((this.user?.person?.id ? ''+this.user?.person?.id:''));\r\n  \r\n        if (response.heritages.length) {\r\n          this.store.dispatch(HeritagePerson({ heritages: response }));\r\n        }\r\n      } catch (error) {\r\n        // console.log(error);\r\n      }\r\n      return;\r\n    }\r\n  }\r\n\r\n  async statesItems(user?:any): Promise<void>{\r\n    console.log(user);\r\n    if(this.updateState && localStorage?.itemsStatesHeritage){\r\n      try {\r\n        const ids = JSON.parse(localStorage?.itemsStatesHeritage);\r\n\r\n        if(ids.length) {\r\n          const res: any = this.HeritageService.updateStates(ids);\r\n  \r\n          console.log(res)\r\n          if(res){\r\n            localStorage.itemsStatesHeritage = JSON.stringify([]);\r\n            this.store.dispatch(HeritagePerson({heritages: []}));\r\n            this.store.dispatch(HeritageUpdateStates());\r\n          }\r\n        }\r\n      } catch (error) {\r\n        // console.log(error);\r\n      }\r\n    }\r\n\r\n    this.updateState = !this.updateState;\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { StartHeritageComponent } from './start-heritage/start-heritage.component';\r\nimport { HeritageComponent } from './heritage.component';\r\nimport { HeritageRoutingModule } from './heritage-routing.module';\r\nimport { SharedModule } from 'src/app/components/shared.module';\r\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\r\nimport { NgSelectModule } from '@ng-select/ng-select';\r\nimport { NgApexchartsModule } from 'ng-apexcharts';\r\nimport { CreateHeritageComponent } from './create/create-heritage.component';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    StartHeritageComponent,\r\n    HeritageComponent,\r\n    CreateHeritageComponent\r\n  ],\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    ReactiveFormsModule,\r\n    NgSelectModule,\r\n    NgApexchartsModule,\r\n    HeritageRoutingModule,\r\n    SharedModule,\r\n  ],\r\n})\r\nexport class HeritageModule { }\r\n"],"sourceRoot":"webpack:///","file":"497.6e7b98ed409fbded0a33.js"}